\documentclass[a4paper, 11pt, notitlepage, english]{article}

\usepackage{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc, url}
\usepackage{textcomp}
\usepackage{amsmath, amssymb}
\usepackage{amsbsy, amsfonts}
\usepackage{graphicx, color}
\usepackage{parskip}
\usepackage{framed}
\usepackage{amsmath}
\usepackage{xcolor}
\usepackage{multicol}
\usepackage{url}
\usepackage{flafter}
\usepackage{simplewick}
\usepackage{amsthm}

\newtheorem{theorem}[]{Wick's Theorem}[]



\usepackage{geometry}
\geometry{headheight=0.01mm}
\geometry{top=20mm, bottom=20mm, left=34mm, right=34mm}

\renewcommand{\arraystretch}{2}
\setlength{\tabcolsep}{10pt}
\makeatletter
\renewcommand*\env@matrix[1][*\c@MaxMatrixCols c]{%
  \hskip -\arraycolsep
  \let\@ifnextchar\new@ifnextchar
  \array{#1}}
%
% Parametere for inkludering av kode fra fil
%
\usepackage{listings}
\lstset{language=python}
\lstset{basicstyle=\ttfamily\small}
\lstset{frame=single}
\lstset{keywordstyle=\color{red}\bfseries}
\lstset{commentstyle=\itshape\color{blue}}
\lstset{showspaces=false}
\lstset{showstringspaces=false}
\lstset{showtabs=false}
\lstset{breaklines}

%
% Definering av egne kommandoer og milj√∏er
%
\newcommand{\dd}[1]{\ \text{d}#1}
\newcommand{\f}[2]{\frac{#1}{#2}} 
\newcommand{\beq}{\begin{equation}}
\newcommand{\eeq}{\end{equation}}
\newcommand{\bra}[1]{\langle #1|}
\newcommand{\ket}[1]{|#1 \rangle}
\newcommand{\braket}[2]{\langle #1 | #2 \rangle}
\newcommand{\braup}[1]{\langle #1 \left|\uparrow\rangle\right.}
\newcommand{\bradown}[1]{\langle #1 \left|\downarrow\rangle\right.}
\newcommand{\av}[1]{\left| #1 \right|}
\newcommand{\op}[1]{\hat{#1}}
\newcommand{\braopket}[3]{\langle #1 | {#2} | #3 \rangle}
\newcommand{\ketbra}[2]{\ket{#1}\bra{#2}}
\newcommand{\pp}[1]{\frac{\partial}{\partial #1}}
\newcommand{\ppn}[1]{\frac{\partial^2}{\partial #1^2}}
\newcommand{\up}{\left|\uparrow\rangle\right.}
\newcommand{\upup}{\left|\uparrow\uparrow\rangle\right.}
\newcommand{\down}{\left|\downarrow\rangle\right.}
\newcommand{\downdown}{\left|\downarrow\downarrow\rangle\right.}
\newcommand{\updown}{\left|\uparrow\downarrow\rangle\right.}
\newcommand{\downup}{\left|\downarrow\uparrow\rangle\right.}
\newcommand{\bupup}{\left.\langle\uparrow\uparrow\right|}
\newcommand{\bdowndown}{\left.\langle\downarrow\downarrow\right|}
\newcommand{\bupdown}{\left.\langle\uparrow\downarrow\right|}
\newcommand{\bdownup}{\left.\langle\downarrow\uparrow\right|}
\renewcommand{\d}{{\rm d}}
\newcommand{\Res}[2]{{\rm Res}(#1;#2)}
\newcommand{\To}{\quad\Rightarrow\quad}
\newcommand{\eps}{\epsilon}
\newcommand{\inner}[2]{\langle #1 , #2 \rangle}


\newcommand{\bt}[1]{\boldsymbol{#1}}
\newcommand{\mat}[1]{\textsf{\textbf{#1}}}
\newcommand{\I}{\boldsymbol{\mathcal{I}}}
\newcommand{\p}{\partial}
%
% Navn og tittel
%
\author{Jonas van den Brink \\ \texttt{j.v.brink@fys.uio.no}}
\title{Problem set 3 \\ FYS-KJM4480}
\date{September}

\begin{document}
\maketitle

In this problem set we will be looking more at second quantization. To get a more compact notation, we will use the following shorthand for the creation and annihilation operators throughout
$$\op{\alpha}^\dag \equiv \op{a}_\alpha^\dag \quad \mbox{and} \quad \op{\alpha} = \op{a}_\alpha.$$

\section*{Exercise 5}
For the first exercise, we will be looking closer at the general onebody and twobody operators, and how they are affected by a change of single-particle basis. We also look into number of particles and number of pairs operators in second quantization.

In second quantization a general onebody operator can be written
$$\op{T} = \sum_{\alpha\beta} \braopket{\alpha}{\op{t}}{\beta} \op{\alpha}^\dag \op{\beta},$$
and a general twobody operator as
$$\op{V} = \frac{1}{2}\sum_{\alpha\beta\gamma\delta} \braopket{\alpha\beta}{\op{v}}{\gamma\delta} \op{\alpha}^\dag \op{\beta}^\dag \op{\delta} \op{\gamma}.$$

\subsection*{Change of Basis}
We will now study what happens to these operators when we perform a change of single-particle basis. The general idea here, is that if we have a ket basis, $\{\phi_i\}_i$ then any ket can be expressed as a linear combination of these basis kets
$$\ket{\psi} = \sum_i c_i \ket{\phi_i},$$
where the coefficicents $c_i$ are generally complex numbers and can be found by taking the inner product 
$$c_i = \braket{\phi_i}{\psi},$$
which corresponds to projecting $\ket{\psi}$ onto the basis-ket $\ket{\phi_i}$. This means we can write any ket as
$$\ket{\psi} = \sum_i  \braket{\phi_i}{\psi}\ket{\phi_i},$$
and as the inner product is simply a number, we can rearrange this into
$$\ket{\psi} = \sum_i  \ket{\phi_i}\braket{\phi_i}{\psi}.$$
And from this we get what is called \emph{the completeness relation}, which states that 
$$\sum_k \ketbra{\phi_k}{\phi_k} = 1,$$
for any ket basis $\{\phi_k\}_k$. We will use this relation to show that a change of single-particle basis does not alter the form of the onebody and twobody operators in second quantization.

\subsubsection*{Onebody operator}
We now look at two distinct single-particle basis, we denote one with greek letters, and one with roman letters. To change from the first basis to the second, we insert the completeness relation twice into the onebody operator, 
\begin{align*}
\op{T} &= \sum_{\alpha\beta}\braopket{\alpha}{\op{t}}{\beta}\op{\alpha}^\dag \op{\beta}. \\
&= \sum_{\alpha\beta}\sum_{ab} \braket{\alpha}{a}\braopket{a}{\op{t}}{b}\braket{b}{\beta}\op{\alpha}^\dag \op{\beta}.
\end{align*}
We can freely rearrange the inner products and the operators, as numbers always commute with operators, giving
\begin{align*}
\op{T} &= \sum_{\alpha\beta}\sum_{ab} \braopket{a}{\op{t}}{b}\braket{\alpha}{a}\op{\alpha}^\dag \braket{b}{\beta} \op{\beta}. 
\end{align*}
As the first inner product does not depend on $\alpha$ or $\beta$ we can put them outside the sum, so we rearrange further
$$\op{T} = \sum_{ab} \braopket{a}{\op{t}}{b}\bigg(\sum_\alpha \braket{\alpha}{a}\op{\alpha}^\dag\bigg)\bigg(\sum_\beta \braket{b}{\beta}\op{\beta}\bigg).$$
We now define
$$\sum_\alpha \braket{\alpha}{a}\op{\alpha}^\dag \equiv \op{a}^\dag \quad \mbox{and} \quad \sum_\beta \braket{b}{\beta}\op{\beta}^\dag \equiv \op{b}.$$
This definition may seem ad hoc, but it actually makes a lot of sense. Any operator is independant of a specific basis, but can be \emph{represented} in any basis. However, when we defined the creation and annihilation operators, we defined them by how they act on kets represented in a specific single-particle basis. Therefore, $\op{\alpha}$ and $\op{a}$ are definitly \emph{not} the same operator represented in different basies, just like $\ket{\alpha}$ and $\ket{a}$ are clearly \emph{not} the same states. Our newly defined operators do however \emph{act} on the new basis as the originial creation and annihilation operators acted on the original basis, in the sense that
$$\op{a}^\dag\ket{0} = \ket{a}.$$
We have then shown
$$\op{T} = \sum_{\alpha\beta}\braopket{\alpha}{\op{t}}{\beta}\op{\alpha}^\dag \op{\beta} = \sum_{ab}\braopket{a}{\op{t}}{b}\op{a}^\dag \op{b}.$$
Meaning it has the same form in the two single-particle bases. As the two bases we have used here are completely general, we know that the operator has the same form in \emph{any} single-particle basis, and a change of basis will not change the form of the operator in second quantization.

\clearpage

\subsubsection*{Twobody operator}
We now look at the twobody operator. Again we have two single-particle bases, one denoted with greek letters and one with roman letters. We start of by inserting the completeness relation four times
\begin{align*}
\op{V} &= \frac{1}{2}\sum_{\alpha\beta\gamma\delta} \braopket{\alpha\beta}{\op{v}}{\gamma\delta} \op{\alpha}^\dag \op{\beta}^\dag \op{\delta} \op{\gamma} \\
&= \frac{1}{2}\sum_{\alpha\beta\gamma\delta} \sum_{abcd}\braket{\alpha\beta}{ab}\braopket{ab}{\op{v}}{cd}\braket{cd}{\gamma\delta} \op{\alpha}^\dag \op{\beta}^\dag \op{\delta} \op{\gamma}.
\end{align*}
Looking close at the inner product $\braket{\alpha\beta}{ab}$ we find
\begin{align*}
\braket{\alpha \beta}{ab} &= \int \psi_{\alpha}(x_1)\psi_a(x_1)\psi_{\beta}(x_2)\psi_b(x_2) \ \d x_1 \d x_2 \\
&= \int \psi_{\alpha}(x_1)\psi_a(x_1) \ \d x_1 \int \psi_{\beta}(x_2)\psi_b(x_2) \d x_2 \\
&= \braket{\alpha}{a}\braket{\beta}{b}.
\end{align*}
Using this together with the fact that all inner products commute with each other gives us
\begin{align*}
\op{V} &= \frac{1}{2}\sum_{\alpha\beta\gamma\delta} \sum_{abcd} \braopket{ab}{\op{v}}{cd} \braket{\alpha}{a} \op{\alpha}^\dag \braket{\beta}{b}\op{\beta}^\dag \braket{d}{\delta}\op{\delta} \braket{c}{\gamma} \op{\gamma}.
\end{align*}
We can now move the sums around
\begin{align*}
\op{V} &= \frac{1}{2} \sum_{abcd} \braopket{ab}{\op{v}}{cd} \bigg(\sum_{\alpha}\braket{\alpha}{a} \op{\alpha}^\dag \bigg)\bigg(\sum_{\beta}\braket{\beta}{b}\op{\beta}^\dag \bigg)\bigg(\sum_{\delta}\braket{d}{\delta}\op{\delta} \bigg)\bigg(\sum_{\gamma}\braket{c}{\gamma} \op{\gamma}\bigg).
\end{align*}
And we recognize this as equivalent to the onebody case, were we defined
$$\sum_\alpha \braket{\alpha}{a}\op{\alpha}^\dag \equiv \op{a}^\dag.$$
So we have
$$\op{V} = \frac{1}{2}\sum_{\alpha\beta\gamma\delta}\braopket{\alpha\beta}{\op{v}}{\gamma\delta}\op{\alpha}^\dag \op{\beta}^\dag \op{\delta} \op{\gamma} = \frac{1}{2}\sum_{abcc}\braopket{ab}{\op{v}}{cd}\op{a}^\dag \op{b}^\dag \op{d} \op{c}.$$
We now see that the twobody operator has the same form in the two single-particle bases, and again we can make the argument---as the single-particle bases used were completely general, the twobody operator has the same form for \emph{any} single-particle basis in second quantization.

\subsubsection*{Number operator}
We will now look closer into the number of particles operator. As we are looking at fermions, we know that any given single-particle state, i.e., \emph{orbital}, can either be occupied or vacant. The name, \emph{number of particles}-operator, can therefore only give the results zero or one. For bosons however, it can be any non-negative integer. We have earlier shown that the number operator for the state $\ket{\alpha}$ is
$$\op{n}_\alpha = \op{\alpha}^\dag \op{\alpha},$$
which for ferimons has the property
$$\op{n}_\alpha \ket{\beta} = \delta_{\alpha\beta}\ket{\beta}.$$

Completely analogously, it is obvious that the number operator for the orbital $\ket{i}$ is
$$\op{n}_i = \op{i}^\dag \op{i},$$
in the sense that
$$\op{n}_i \ket{j} = \delta_{ij}\ket{j}.$$
Again we have defined the analog operator by the way it acts on the basis functions. This means that as before, the two operators are definitly \emph{not} the same operator represented in different basises. The states $\ket{\alpha}$ and $\ket{i}$ are completely different states! If we insert our definition of $\op{i}^\dag$ and $\op{i}$ we find
$$\op{n}_i = \sum_{\alpha}\braket{\alpha}{a}\op{\alpha}^\dag \sum_{\beta} \braket{a}{\beta}\op{\beta} = \sum_{\alpha\beta} \braket{a}{\alpha}\braket{\beta}{a} \op{\alpha}^\dag \op{\beta} = \sum_\alpha \op{\alpha}^\dag \op{\alpha} = \sum_\alpha \op{n}_\alpha.$$
And so we see that when representing the number operator for the state $\ket{i}$, $\op{n}_i$, in the basis for $\ket{\alpha}$, it is the sum over all the basis kets. This result is actually quite intuitive, as $\op{n}_i$ "picks out" the orbital $\ket{i}$, it should pick out the components of all $\ket{\alpha}$'s that form $\ket{i}$. Let us check that this in fact works. In the $\ket{i}$-basis, we know that
$$\op{n}_i \ket{i} = \ket{i},$$
easy as that. But now, let's insert the representations of both the number operator and the base ket in the $\ket{\alpha}$-basis, and see if we get the same result
$$\op{n}_i \ket{i} = \sum_{\alpha}\op{n}_\alpha \sum_{\alpha'}\braket{\alpha'}{i}\ket{\alpha'}.$$
The inner-product is a number, and so commutes with the number operator, and as there is no dependance on $\alpha$, we can rearrange the terms as follows
$$\op{n}_i \ket{i} =  \sum_{\alpha'}\braket{\alpha'}{i} \sum_{\alpha}\op{n}_\alpha\ket{\alpha'}.$$
And now we let the operator act on the ket, and take the sum to find 
$$\op{n}_i \ket{i} = \sum_{\alpha'}\braket{\alpha'}{i} \sum_{\alpha} \delta_{\alpha \alpha'}\ket{\alpha'} = \sum_{\alpha'} \braket{\alpha'}{i}\ket{\alpha'} = \ket{i}.$$
And so we see that everything does in fact make sense.

\subsubsection*{Rewriting the onebody operator}

Let us look at what happens to the onebody operator if $T$ is diagonal in our single-particle basis, $\{\phi_i\}$. That $T$ is diagonal in the basis means that every off-diagonal matrix element is zero, this means that we can write any matrix element as
$$\braopket{i}{\op{t}}{j} = \eps_i \delta_{ij},$$
where $\eps_i$ is a given constant. This again corresponds to the single-particle basis being eigenkets for the $\op{t}$-operator, with eigenvalues $\eps_i$. If this is the case, we can rewrite $\op{T}$ as follows (remember that $\op{T}$ has the same form in \emph{any} basis, including the basis of eigenkets)
\begin{align*}
\op{T} &= \sum_{\alpha \beta} \braopket{\alpha}{\op{t}}{\beta} \op{\alpha}^\dag \op{\beta} 
= \sum_{\alpha \beta} \eps_\alpha \delta_{\alpha\beta} \op{\alpha}^\dag \op{\beta} 
= \sum_{\alpha} \eps_\alpha \op{\alpha}^\dag \op{\alpha} 
= \sum_{\alpha} \eps_\alpha \op{n}_\alpha.
\end{align*}
So we see that if our single-particle basis are eigenkets of $\op{t}$, then we simply need to sum over the eigenvalues of all occupied states---this result is very intuitive.

\subsubsection*{Number of pair operators}
We have now looked at the number operator, which told us if a single-particle orbital was occupied or not, and saw that in the right basis, the onebody operator could be simplified considerably using the number operator. We will now introduce the number of pairs operator. We give the ansatz
$$\op{N}_p = \frac{1}{2}\sum_{\alpha \neq \beta} \op{\alpha}^\dag \op{\beta}^\dag \op{\beta} \op{\alpha}.$$
Let us study the action of this operator on a given Slater-determinant. First we note
$$\op{\alpha}^\dag  \op{\beta}^\dag \op{\beta} \op{\alpha} \ket{\cdots\alpha\cdots\beta\cdots} = (-)^{p_1}(-)^{p_2} \op{\alpha}^\dag  \op{\beta}^\dag \ket{\cdots} = \ket{\cdots\alpha\cdots\beta\cdots},$$
$$\op{\alpha}^\dag  \op{\beta}^\dag \op{\beta} \op{\alpha} \ket{\cdots\beta\cdots} = 0,$$
$$\op{\alpha}^\dag  \op{\beta}^\dag \op{\beta} \op{\alpha} \ket{\cdots\alpha\cdots} = 0,$$
$$\op{\alpha}^\dag  \op{\beta}^\dag \op{\beta} \op{\alpha} \ket{\cdots} = 0.$$
So if we say that our Slater-determinant consists of the states $\{\phi_i\}_{i=1}^n$, meaning we have a $n$-particles in our system, we get
$$\op{N}_p \ket{SD} = \frac{1}{2}\sum_{\alpha \neq \beta} \op{\alpha}^\dag \op{\beta}^\dag \op{\beta} \op{\alpha}\ket{SD} = \frac{1}{2} \sum_{i=1}^N \sum_{\substack{j=1 \\ j\neq i}}^N \ket{SD} = \frac{n(n-1)}{2}\ket{SD}.$$
So we see that the result of $\op{N}_p$ on the $n$-particle Slater determinant gives $n(n-1)/2$, which corresponds to the number of unordered pairs possible in the system. The operator thus acts just like we want a number of pairs operator to behave.

\subsubsection*{Rewriting the twobody operator}
When looking at the twobody operator in second quantization
$$\op{V} = \frac{1}{2}\sum_{\alpha\beta\gamma\delta}\braopket{\alpha\beta}{\op{v}}{\gamma\delta}\op{\alpha}^\dag\op{\beta}^\dag \op{\delta}\op{\gamma},$$
we notice that when $\alpha=\gamma$ and $\beta=\delta$, the form resembles the number of pairs operator. Also, when $\alpha=\delta$ and $\beta=\gamma$ we can rearrange the operators as follows
$$\alpha^\dagger\beta^\dagger\alpha \beta = -\alpha^\dagger\beta^\dagger \beta\alpha.$$
Using all this, we get
$$\op{V} = \frac{1}{2}\sum_{\alpha \neq \beta} \braopket{\alpha\beta}{\op{v}}{\alpha\beta}_{\rm AS}\op{\alpha}^\dag\op{\beta}^\dag\op{\beta}\op{\alpha} + \frac{1}{2}\sum_{\alpha}\sum_{\beta\neq\alpha}\sum_{\substack{\gamma\neq\alpha \\ \gamma \neq\beta}}\sum_{\substack{\delta\neq\alpha \\\delta\neq\beta\\ \delta \neq \gamma}} \braopket{\alpha\beta}{\op{v}}{\gamma\delta}\op{\alpha}^\dag\op{\beta}^\dag \op{\delta}\op{\gamma} .$$
Where we see that the first term is a weighted number of pairs sum. We can rewrite this as follows
$$\op{\alpha}^\dag\op{\beta}^\dag \op{\beta} \op{\alpha} = \op{\alpha}^\dag \op{\alpha}\op{\beta}^\dag\op{\beta} - \delta_{\alpha\beta}\op{\alpha}^\dag\op{\beta}.$$
The Kronecker-delta kills the second term, as $\alpha\neq\beta$, leaving only
$$\op{\alpha}^\dag\op{\alpha} \op{\beta}^\dag \op{\beta} = \op{n}_\alpha \op{n}_\beta.$$
We can then write the twobody operator as
$$\op{V} = \frac{1}{2}\sum_{\alpha \neq \beta} \braopket{\alpha\beta}{\op{v}}{\alpha\beta}_{\rm AS}\op{n}_\alpha \op{n}_\beta + \frac{1}{4}\sum_{\alpha}\sum_{\beta\neq\alpha}\sum_{\substack{\gamma\neq\alpha \\ \gamma \neq\beta}}\sum_{\substack{\delta\neq\alpha \\\delta\neq\beta\\ \delta \neq \gamma}} \braopket{\alpha\beta}{\op{v}}{\gamma\delta}_{\rm AS}\op{\alpha}^\dag\op{\beta}^\dag \op{\delta}\op{\gamma} .$$

\clearpage

\section*{Exercise 6}

In this exercise we introduce the concepts of \emph{normal products} and \emph{contractions} of operators, which allows us to take in use \emph{Wick's theorem}. We start by defining these concepts and explaining Wick's theorem, before going into the exercise.

\subsection*{Normal products and contractions of operators}
The normal product of a set of creation and annihilation operators is the rearranged product such that all creation operators are to the left and all the annhilation operators are to the right. This rearrangement of course leads to a change of sign according to the parity of the rearrangement. Let us give an example where the operators $\op{A}$, $\op{B}$, $\op{C}$ are all products of creation and annihilation operators
$$n[\op{A}\op{B}\op{C}] = (-)^p \op{\alpha}^\dag \op{\gamma}^\dag \cdots \op{\beta}\op{\gamma}.$$
Note that the order of the normal product is \emph{not} unique, as we only require all the creation to be at the start, the order of the creation operators is unimportant. It is important to note that in general 
$$n[\op{A}\op{B}\op{C}] \neq \op{A}\op{B}\op{C},$$
meaning the normal product is \emph{not} simply just a rearrangement of the operators. This is because of the anticommutation relation $\{\op{\alpha}^\dag \op{\beta}\} = \delta_{\alpha \beta}$, meaning simple rearrangements will introduce more terms.

We now note that since the creation operators are to the left and the annhiliation operators are to the right hand side of the normal product, the vacuum expectation of a normal product will always vanish
$$\braopket{0}{n[\op{Q}]}{0} = 0,$$
for any $\op{Q}$ that is a product of creation and annihilation operators.


We now define the \emph{contraction} of two operators as follow
$$\bcontraction{}{\op{A}}{}{\op{B}} \op{A}\op{B} \equiv \op{A}\op{B} - n[\op{A}\op{B}].$$
As contraction always work on operators, we will ocassionaly drop the operator accents when writing the contractions, e.g., $\contraction{\op{A}}{B}{\op{C}}{D} \op{A}B\op{C}D.$

Let us now look at the contraction of simple creation and annhilation operators. The four possibilites are
\begin{align*}
\bcontraction[1ex]{}{\alpha}{^\dag}{\beta} \op{\alpha}^\dag \op{\beta}^\dag &= \op{\alpha}^\dag \op{\beta}^\dag - \op{\alpha}^\dag \op{\beta}^\dag = 0, \\
\bcontraction[1ex]{}{\alpha}{}{\beta} \op{\alpha} \op{\beta} &= \op{\alpha} \op{\beta} - \op{\alpha} \op{\beta} = 0, \\
\bcontraction[1ex]{}{\alpha}{^\dag}{\beta} \op{\alpha}^\dag \op{\beta} &= \op{\alpha}^\dag \op{\beta} - \op{\alpha}^\dag \op{\beta} = 0, \\
\bcontraction[1ex]{}{\alpha}{}{\beta} \op{\alpha} \op{\beta}^\dag &= \op{\alpha}^\dag \op{\beta}^\dag - (- \op{\alpha}^\dag \op{\beta}^\dag) = \{\op{\alpha}\op{\beta}^\dag\} = \delta_{\alpha\beta}.\\
\end{align*}
So we see that most contractions vanish, or become unitiary, it is therefore apparant that taking contractions will usually severly simplify our problem. If we are looking at the normal product of a set of operators containing a contraction, then we can 'extract' the contraction from the normal product as follows
$$n[\op{A}\op{B}\op{C}\ldots \bcontraction{}{G}{\ldots}{H}\op{G}\ldots \op{H}\ldots] = (-)^p \bcontraction{}{G}{}{H}\op{G}\op{H} n[\op{A}\op{B}\op{C}\ldots],$$
where the sign is due to the parity of the contracted operators. We now see that the result is either zero, or just the normal product with the contracted pair removed with a sign in front. Using this final result, we are now ready to introduce Wick's theorem.

\vspace{0.2cm}

\begin{description}
 	\item[\qquad Wick's Theorem] $ $\\
 	A general product of creation an annihilation operators is equal to their normal product plus the sum of all possible normal products with contractions.
\end{description}
This means we get sum with all possible single contractions, all possible double contractions and so forth. Let us look at an example for a string of four creation and annhiliation operators, we will then get the normal product, the normal products of the 6 possible single contractions, and the normal products of the 3 possible single contractions for a total of 10 terms.
\begin{align*}
\op{a}\op{b}\op{c}\op{d} &= n[\op{a}\op{b}\op{c}\op{d}] \\
&\quad + n[\bcontraction{}{a}{}{b}\op{a}\op{b}\op{c}\op{d}] 
+ n[\bcontraction{}{a}{b}{c}\op{a}\op{b}\op{c}\op{d}] 
+ n[\bcontraction{}{a}{bc}{d}\op{a}\op{b}\op{c}\op{d}] 
+ n[\bcontraction{a}{b}{}{c}\op{a}\op{b}\op{c}\op{d}] 
+ n[\bcontraction{a}{b}{c}{d}\op{a}\op{b}\op{c}\op{d}] + n[\bcontraction{ab}{c}{}{d}\op{a}\op{b}\op{c}\op{d}] \\
&\quad + n[\bcontraction[1ex]{}{a}{}{b}\bcontraction[1ex]{ab}{c}{}{d}\op{a}\op{b}\op{c}\op{d}] + n[\bcontraction[1ex]{}{a}{b}{c}\bcontraction[2ex]{a}{b}{c}{d}\op{a}\op{b}\op{c}\op{d}] + n[\bcontraction[2ex]{}{a}{bc}{d}\bcontraction[1ex]{a}{b}{}{c}\op{a}\op{b}\op{c}\op{d}]
\end{align*}
The reason we want to write our operators out in this fashion is due to the fact that most of these terms vanish in practice. In fact, if we look at the vacuum expectation of these operators, only the term where all operators are contracted will survive. This is due to the fact that any normal product of a nonempty group has a vacuum expectency of zero, and so all operators must be contracted out. We are now ready to take Wick's theorem into use and look at the exercises.


\subsection*{a)}
We want to calculate the magnitude of the Slater determinant
$$\ket{\Phi_0} = \prod_{i=1}^n \op{\alpha}_i^\dag \ket{0},$$
using Wick's theorem. We start by finding the corresponding bra
$$\bra{\Phi_0} = \ket{\Phi_0}^\dag = \bigg(\prod_{i=1}^n \op{\alpha}_i^\dag \ket{0}\bigg)^\dag = \bra{0}\prod_{i=0}^{n-1} \op{a}_{n-i}.$$
So the magnitude can be written
$$\braket{\Phi_0}{\Phi_0} = \braopket{0}{\op{a}_{n}\op{a}_{n-1}\cdots\op{a}_2\op{a}_{1}\op{a}_{1}^\dag\op{a}_{2}^\dag\cdots\op{a}_{n-1}^\dag\op{a}_{n}^\dag}{0}.$$
Using Wick's theorem, we can now write the string of creation and annihilation operators as a sum of normal products with any possible combination of contractions, but as we know, only the terms where all operators are contracted will survive. However, we also know that the only contraction to not vanish is
$$\op{\alpha}\op{\beta}^\dag = \delta_{\alpha \beta}.$$
Meaning the only contribution to the inner product is the term where $\op{a}_i$ is contracted with $\op{i}$.
\begin{align*}
\braket{\Phi_0}{\Phi_0} = \braopket{0}{n[
\contraction[3ex]{}{a}{_n{a}_{n-1}\cdots a_2{a}_{1}{a}_{1}^\dag{a}_{2}^\dag\cdots a_{n-1}^\dag}{a}
\contraction[2ex]{a_n}{a}{_{n-1}\cdots a_2{a}_{1}{a}_{1}^\dag{a}_{2}^\dag\cdots }{a}
\bcontraction[2ex]{a_n a_{n-1}\cdots }{a}{_2{a}_{1}{a}_{1}^\dag}{a}
\bcontraction[1ex]{a_n a_{n-1}\cdots a_2}{a}{_{1}}{a}
{a}_{n}{a}_{n-1}\cdots a_2 {a}_{1}{a}_{1}^\dag{a}_{2}^\dag\cdots a_{n-1}^\dag {a}_{n}^\dag]}{0}.
\end{align*}
Taking all the contractions gives
\begin{align*}
\braket{\Phi_0}{\Phi_0} = \bigg(\prod_{i=1}^n \delta_{ii}\bigg) \braket{0}{0} = 1.
\end{align*}
And we see that the Slater determinant is normalized as expected.

\subsection*{b)}
In this exercise we want to compute the matrix element
$$\braopket{a_1a_2a_3}{G}{b_1b_2b_3},$$
using second quantization notation and Wick's theorem. First, inserting for the twobody operator in second quantization and writing the states as vacuum states we have
$$\braopket{a_1a_2a_3}{G}{b_1b_2b_3} = \frac{1}{2}\sum_{ijkl} \braopket{0}{\op{a}_3 \op{a}_2 \op{a}_1 \op{i}^\dag \op{j}^\dag \op{k} \op{l} \op{b}_1^\dag\op{b}_2^\dag\op{b}_3^\dag}{0}.$$
We now use Wick's theorem on the string of creation and annihilation operators. We know that only the terms where all the operators are contracted will contribute to the final result, and also that only contractions on the form $\bcontraction{}{\alpha}{}{\beta}\alpha \beta^\dag$ contribute.So Wick's theorem gives
\begin{align*}
\braopket{a_1a_2a_3}{G}{b_1b_2b_3} = \frac{1}{2}\sum_{ijkl} \braopket{ij}{\op{g}}{kl} \bra{0} \bigg(
&
%
n\big[
\bcontraction{}{a}{_1a_2 a_3}{i}
\bcontraction[2ex]{a_1}{a}{_2 a_3 i^\dag}{j}
\bcontraction[3ex]{a_1a_2}{a}{_3i^\dag j^\dag k l}{a}
\bcontraction[1ex]{a_1a_2a_3 i^\dag j^\dag}{k}{l b_1^\dag }{b}
\bcontraction[2ex]{a_1a_2a_3 i^\dag j^\dag k}{l}{b_1^\dag b_2^\dag}{b}
\op{a}_3 \op{a}_2 \op{a}_1 \op{i}^\dag \op{j}^\dag \op{k} \op{l} \op{b}_1^\dag\op{b}_2^\dag\op{b}_3^\dag\big] \\[0.1cm]
%
%
&\quad+n\big[
\bcontraction{}{a}{_1a_2 a_3}{i}
\bcontraction[2ex]{a_1}{a}{_2 a_3 i^\dag}{j}
\bcontraction[3ex]{a_1a_2}{a}{_3i^\dag j^\dag k l}{a}
\bcontraction[1ex]{a_1a_2a_3 i^\dag j^\dag}{k}{l b_1^\dag b_2^\dag}{b}
\bcontraction[2ex]{a_1a_2a_3 i^\dag j^\dag k}{l}{b_1^\dag}{b}
\op{a}_3 \op{a}_2 \op{a}_1 \op{i}^\dag \op{j}^\dag \op{k} \op{l} \op{b}_1^\dag\op{b}_2^\dag\op{b}_3^\dag\big] +\ldots \bigg)
\end{align*}
Let us look at what happens to such a normal product with contractions. Extracting each pair of operators we get
$$n\big[
\bcontraction{}{a}{_1a_2 a_3}{i}
\bcontraction[2ex]{a_1}{a}{_2 a_3 i^\dag}{j}
\bcontraction[3ex]{a_1a_2}{a}{_3i^\dag j^\dag k l}{b}
\bcontraction[1ex]{a_1a_2a_3 i^\dag j^\dag}{k}{l b_1^\dag}{b}
\bcontraction[2ex]{a_1a_2a_3 i^\dag j^\dag k}{l}{b_1^\dag b_2^\dag}{b}
\op{a}_3 \op{a}_2 \op{a}_1 \op{i}^\dag \op{j}^\dag \op{k} \op{l} \op{b}_1^\dag\op{b}_2^\dag\op{b}_3^\dag\big] = 
%
\bcontraction{}{a}{_3}{i} \op{a}_3\op{i}^\dag
\bcontraction{}{a}{_2}{j} \op{a}_2\op{j}^\dag
\bcontraction{}{a}{_1}{a} \op{a}_1\op{b}_1^\dag
\bcontraction{}{k}{}{a} \op{k}\op{b}_2^\dag
\bcontraction{}{l}{}{a} \op{l}\op{b}_3^\dag n\big[\big].
$$ 
We now simplify this by realizing that the normal product of an empty operator string is just the identity operator, and also that the contraction $\bcontraction{}{\alpha}{}{\beta}\op{\alpha}\op{\beta}^\dag = \delta_{\alpha\beta}.$ We get
$$n\big[
\bcontraction{}{a}{_1a_2 a_3}{i}
\bcontraction[2ex]{a_1}{a}{_2 a_3 i^\dag}{j}
\bcontraction[3ex]{a_1a_2}{a}{_3i^\dag j^\dag k l}{a}
\bcontraction[1ex]{a_1a_2a_3 i^\dag j^\dag}{k}{l a_1^\dag}{a}
\bcontraction[2ex]{a_1a_2a_3 i^\dag j^\dag k}{l}{a_1^\dag b_2^\dag}{a}
\op{a}_3 \op{a}_2 \op{a}_1 \op{i}^\dag \op{j}^\dag \op{k} \op{l} \op{b}_1^\dag\op{b}_2^\dag\op{b}_3^\dag\big] = 
%
\delta_{a_3 i}\delta_{a_2 j}\delta_{a_1 b_1} \delta_{k b_2} \delta_{l b_3}.$$
And when taking the sum over $i, j, k$ and $l$, this term will contribute to the final matrix element as follows
\begin{align*}
\frac{1}{2}\sum_{ijkl} \braopket{ij}{\op{g}}{kl} \braopket{0}{n\big[
\bcontraction{}{a}{_1a_2 a_3}{i}
\bcontraction[2ex]{a_1}{a}{_2 a_3 i^\dag}{j}
\bcontraction[3ex]{a_1a_2}{a}{_3i^\dag j^\dag k l}{a}
\bcontraction[1ex]{a_1a_2a_3 i^\dag j^\dag}{k}{l a_1^\dag}{a}
\bcontraction[2ex]{a_1a_2a_3 i^\dag j^\dag k}{l}{a_1^\dag b_2^\dag}{a}
\op{a}_3 \op{a}_2 \op{a}_1 \op{i}^\dag \op{j}^\dag \op{l} \op{k} \op{b}_1^\dag\op{b}_2^\dag\op{b}_3^\dag\big]}{0} &= \frac{1}{2}\sum_{ijkl} \braopket{ij}{\op{g}}{kl} \delta_{a_3 i}\delta_{a_2 j}\delta_{a_1 b_1} \delta_{k b_2} \delta_{l b_3} \\
&= \frac{1}{2} \braopket{a_3 a_2}{\op{g}}{b_2 b_3} \delta_{a_1 b_1}.
\end{align*}
Now, this is just one of the terms. As there are 5 creation and 5 annihilation operators that must be contracted in the order $\op{\alpha}\op{\beta}^\dag$---this gives a total of 36 normal products with contractions that contribute a term. We can write all these out by using SymPy, and the results are as follows. 
\begin{align*} &\op{C} = \\
&+\delta_{a_{1} b_{1}} \delta_{a_{2} i} \delta_{a_{3} j} \delta_{b_{2} k} \delta_{b_{3} l} 
- \delta_{a_{1} b_{1}} \delta_{a_{2} i} \delta_{a_{3} j} \delta_{b_{2} l} \delta_{b_{3} k} 
- \delta_{a_{1} b_{1}} \delta_{a_{2} j} \delta_{a_{3} i} \delta_{b_{2} k} \delta_{b_{3} l} 
+ \delta_{a_{1} b_{1}} \delta_{a_{2} j} \delta_{a_{3} i} \delta_{b_{2} l} \delta_{b_{3} k} \\
&- \delta_{a_{1} b_{2}} \delta_{a_{2} i} \delta_{a_{3} j} \delta_{b_{1} k} \delta_{b_{3} l} 
+ \delta_{a_{1} b_{2}} \delta_{a_{2} i} \delta_{a_{3} j} \delta_{b_{1} l} \delta_{b_{3} k} 
+ \delta_{a_{1} b_{2}} \delta_{a_{2} j} \delta_{a_{3} i} \delta_{b_{1} k} \delta_{b_{3} l} 
- \delta_{a_{1} b_{2}} \delta_{a_{2} j} \delta_{a_{3} i} \delta_{b_{1} l} \delta_{b_{3} k} \\
&+ \delta_{a_{1} b_{3}} \delta_{a_{2} i} \delta_{a_{3} j} \delta_{b_{1} k} \delta_{b_{2} l} 
- \delta_{a_{1} b_{3}} \delta_{a_{2} i} \delta_{a_{3} j} \delta_{b_{1} l} \delta_{b_{2} k} 
- \delta_{a_{1} b_{3}} \delta_{a_{2} j} \delta_{a_{3} i} \delta_{b_{1} k} \delta_{b_{2} l} 
+ \delta_{a_{1} b_{3}} \delta_{a_{2} j} \delta_{a_{3} i} \delta_{b_{1} l} \delta_{b_{2} k} \\
&- \delta_{a_{1} i} \delta_{a_{2} b_{1}} \delta_{a_{3} j} \delta_{b_{2} k} \delta_{b_{3} l} 
+ \delta_{a_{1} i} \delta_{a_{2} b_{1}} \delta_{a_{3} j} \delta_{b_{2} l} \delta_{b_{3} k} 
+ \delta_{a_{1} i} \delta_{a_{2} b_{2}} \delta_{a_{3} j} \delta_{b_{1} k} \delta_{b_{3} l} 
- \delta_{a_{1} i} \delta_{a_{2} b_{2}} \delta_{a_{3} j} \delta_{b_{1} l} \delta_{b_{3} k} \\
&- \delta_{a_{1} i} \delta_{a_{2} b_{3}} \delta_{a_{3} j} \delta_{b_{1} k} \delta_{b_{2} l} 
+ \delta_{a_{1} i} \delta_{a_{2} b_{3}} \delta_{a_{3} j} \delta_{b_{1} l} \delta_{b_{2} k} 
+ \delta_{a_{1} i} \delta_{a_{2} j} \delta_{a_{3} b_{1}} \delta_{b_{2} k} \delta_{b_{3} l} 
- \delta_{a_{1} i} \delta_{a_{2} j} \delta_{a_{3} b_{1}} \delta_{b_{2} l} \delta_{b_{3} k} \\
&- \delta_{a_{1} i} \delta_{a_{2} j} \delta_{a_{3} b_{2}} \delta_{b_{1} k} \delta_{b_{3} l} 
+ \delta_{a_{1} i} \delta_{a_{2} j} \delta_{a_{3} b_{2}} \delta_{b_{1} l} \delta_{b_{3} k} 
+ \delta_{a_{1} i} \delta_{a_{2} j} \delta_{a_{3} b_{3}} \delta_{b_{1} k} \delta_{b_{2} l} 
- \delta_{a_{1} i} \delta_{a_{2} j} \delta_{a_{3} b_{3}} \delta_{b_{1} l} \delta_{b_{2} k} \\
&+ \delta_{a_{1} j} \delta_{a_{2} b_{1}} \delta_{a_{3} i} \delta_{b_{2} k} \delta_{b_{3} l} 
- \delta_{a_{1} j} \delta_{a_{2} b_{1}} \delta_{a_{3} i} \delta_{b_{2} l} \delta_{b_{3} k} 
- \delta_{a_{1} j} \delta_{a_{2} b_{2}} \delta_{a_{3} i} \delta_{b_{1} k} \delta_{b_{3} l} 
+ \delta_{a_{1} j} \delta_{a_{2} b_{2}} \delta_{a_{3} i} \delta_{b_{1} l} \delta_{b_{3} k} \\
&+ \delta_{a_{1} j} \delta_{a_{2} b_{3}} \delta_{a_{3} i} \delta_{b_{1} k} \delta_{b_{2} l} 
- \delta_{a_{1} j} \delta_{a_{2} b_{3}} \delta_{a_{3} i} \delta_{b_{1} l} \delta_{b_{2} k} 
- \delta_{a_{1} j} \delta_{a_{2} i} \delta_{a_{3} b_{1}} \delta_{b_{2} k} \delta_{b_{3} l} 
+ \delta_{a_{1} j} \delta_{a_{2} i} \delta_{a_{3} b_{1}} \delta_{b_{2} l} \delta_{b_{3} k} \\
&+ \delta_{a_{1} j} \delta_{a_{2} i} \delta_{a_{3} b_{2}} \delta_{b_{1} k} \delta_{b_{3} l} 
- \delta_{a_{1} j} \delta_{a_{2} i} \delta_{a_{3} b_{2}} \delta_{b_{1} l} \delta_{b_{3} k} 
- \delta_{a_{1} j} \delta_{a_{2} i} \delta_{a_{3} b_{3}} \delta_{b_{1} k} \delta_{b_{2} l} 
+ \delta_{a_{1} j} \delta_{a_{2} i} \delta_{a_{3} b_{3}} \delta_{b_{1} l} \delta_{b_{2} k}
\end{align*}
We can treat each of these terms as we have above. When taking the sum over $i, j, k$ and $l$, we get the following contributions to the final matrix element
\begin{align*}
&\frac{1}{2}\sum_{ijkl} \braopket{ij}{\op{g}}{kl}\braopket{0}{\op{C}}{0} = \frac{1}{2}\big( \\
&+ \braopket{a_2 a_3}{\op{g}}{b_2 b_3} \delta_{a_{1} b_{1}}
- \braopket{a_2 a_3}{\op{g}}{b_3 b_2} \delta_{a_{1} b_{1}}
- \braopket{a_3 a_2}{\op{g}}{b_2 b_3} \delta_{a_{1} b_{1}}
+ \braopket{a_3 a_2}{\op{g}}{b_3 b_2} \delta_{a_{1} b_{1}} \\
% 
&- \braopket{a_2 a_3}{\op{g}}{b_1 b_3} \delta_{a_{1} b_{2}}
+ \braopket{a_2 a_3}{\op{g}}{b_3 b_1} \delta_{a_{1} b_{2}}
+ \braopket{a_3 a_2}{\op{g}}{b_1 b_3} \delta_{a_{1} b_{2}}
- \braopket{a_3 a_2}{\op{g}}{b_3 b_1} \delta_{a_{1} b_{2}} \\
% 
&+ \braopket{a_2 a_3}{\op{g}}{b_1 b_2} \delta_{a_{1} b_{3}}
- \braopket{a_2 a_3}{\op{g}}{b_2 b_1} \delta_{a_{1} b_{3}}
- \braopket{a_3 a_2}{\op{g}}{b_1 b_2} \delta_{a_{1} b_{3}}
+ \braopket{a_3 a_2}{\op{g}}{b_2 b_1} \delta_{a_{1} b_{3}} \\
% 
&- \braopket{a_1 a_3}{\op{g}}{b_2 b_3} \delta_{a_{2} b_{1}}
+ \braopket{a_1 a_3}{\op{g}}{b_3 b_2} \delta_{a_{2} b_{1}}
+ \braopket{a_3 a_1}{\op{g}}{b_2 b_3} \delta_{a_{2} b_{1}}
- \braopket{a_3 a_1}{\op{g}}{b_3 b_2} \delta_{a_{2} b_{1}} \\
% 
&+ \braopket{a_1 a_3}{\op{g}}{b_1 b_3} \delta_{a_{2} b_{2}}
- \braopket{a_1 a_3}{\op{g}}{b_3 b_1} \delta_{a_{2} b_{2}}
- \braopket{a_3 a_1}{\op{g}}{b_1 b_3} \delta_{a_{2} b_{2}}
+ \braopket{a_3 a_1}{\op{g}}{b_3 b_1} \delta_{a_{2} b_{2}} \\
% 
&- \braopket{a_1 a_3}{\op{g}}{b_1 b_2} \delta_{a_{2} b_{3}}
+ \braopket{a_1 a_3}{\op{g}}{b_2 b_1} \delta_{a_{2} b_{3}}
+ \braopket{a_3 a_1}{\op{g}}{b_1 b_2} \delta_{a_{2} b_{3}}
- \braopket{a_3 a_1}{\op{g}}{b_2 b_1} \delta_{a_{2} b_{3}} \\
% 
&+ \braopket{a_1 a_2}{\op{g}}{b_2 b_3} \delta_{a_{3} b_{1}}
- \braopket{a_1 a_2}{\op{g}}{b_3 b_2} \delta_{a_{3} b_{1}}
- \braopket{a_2 a_1}{\op{g}}{b_2 b_3} \delta_{a_{3} b_{1}}
+ \braopket{a_2 a_1}{\op{g}}{b_3 b_2} \delta_{a_{3} b_{1}} \\
%
&+ \braopket{a_2 a_1}{\op{g}}{b_1 b_3} \delta_{a_{3} b_{2}}
- \braopket{a_2 a_1}{\op{g}}{b_3 b_1} \delta_{a_{3} b_{2}}
- \braopket{a_1 a_2}{\op{g}}{b_1 b_3} \delta_{a_{3} b_{2}}
+ \braopket{a_1 a_2}{\op{g}}{b_3 b_1} \delta_{a_{3} b_{2}} \\
%
&+ \braopket{a_1 a_2}{\op{g}}{b_1 b_2} \delta_{a_{3} b_{3}}
- \braopket{a_1 a_2}{\op{g}}{b_2 b_1} \delta_{a_{3} b_{3}}
- \braopket{a_2 a_1}{\op{g}}{b_1 b_2} \delta_{a_{3} b_{3}}
+ \braopket{a_2 a_1}{\op{g}}{b_2 b_1} \delta_{a_{3} b_{3}}\big).
\end{align*}
We note that every line consists of four terms with the same Kroneckerqdelta indices, we can collect these terms in each case. We can also use the the fact that generally
$$\braopket{\alpha \beta}{\op{q}}{\gamma \delta} = \braopket{\beta \alpha}{\op{q}}{\delta \gamma},$$
to combine two and two of the terms. Let us look at the first line as an example
$$
\frac{1}{2}\big(\braopket{a_2 a_3}{\op{g}}{b_2 b_3} 
- \braopket{a_2 a_3}{\op{g}}{b_3 b_2} 
- \braopket{a_3 a_2}{\op{g}}{b_2 b_3} 
+ \braopket{a_3 a_2}{\op{g}}{b_3 b_2}\big)\delta_{a_{1} b_{1}}.
$$
Which can be simplified to
$$\big(\braopket{a_2 a_3}{\op{g}}{b_2 b_3} - \braopket{a_2 a_3}{\op{g}}{b_3 b_2}\big)\delta_{a_{1}b_{1}}.$$
Which can be written even more compactily as
$$\braopket{a_2 a_3}{\op{g}}{b_2 b_3}_{\rm AS} \delta_{a_1b_1}.$$
By using the same simplification for each line, we get the final result
\begin{align*}		
\braopket{a_1a_2a_3}{G}{b_1b_2b_3} &= 
   \braopket{a_2 a_3}{\op{g}}{b_2 b_3}_{\rm AS} \delta_{a_1b_1} \\
&+ \braopket{a_2 a_3}{\op{g}}{b_3 b_1}_{\rm AS} \delta_{a_1b_2}  \\
&+  \braopket{a_2 a_3}{\op{g}}{b_1 b_2}_{\rm AS} \delta_{a_1b_3} \\ 
&+ \braopket{a_1 a_3}{\op{g}}{b_3 b_2}_{\rm AS} \delta_{a_2b_1}  \\
&+  \braopket{a_1 a_3}{\op{g}}{b_1 b_3}_{\rm AS} \delta_{a_2b_2} \\ 
&+ \braopket{a_1 a_3}{\op{g}}{b_2 b_1}_{\rm AS} \delta_{a_2b_3}  \\
&+  \braopket{a_1 a_2}{\op{g}}{b_2 b_3}_{\rm AS} \delta_{a_3b_1} \\ 
&+ \braopket{a_1 a_2}{\op{g}}{b_3 b_1}_{\rm AS} \delta_{a_3b_2}  \\
&+  \braopket{a_1 a_2}{\op{g}}{b_1 b_2}_{\rm AS} \delta_{a_3b_3}  
\end{align*}

We can test our result by looking at our results from last week, where we looked at the matrix elements for general $n$-particle Slater determinants with zero, one, two and three-noncoincidences, which were as follows
\begin{align*}
\braopket{SD}{\op{G}}{SD}
&=  \frac{1}{2}\sum_{\alpha,\beta} \braopket{\alpha\beta}{\op{g}}{\alpha\beta}_{\rm AS},\\
\braopket{SD}{\op{G}}{SD_i^j}
&= \sum_{\alpha} \braopket{\alpha i}{\op{g}}{\alpha j}_{\rm AS}, \\
\braopket{SD}{\op{G}}{SD_{ij}^{kl}} &= \braopket{ij}{\op{g}}{kl}_{\rm AS}, \\
\braopket{SD}{\op{G}}{SD_{ijl}^{lmn}} &= 0.
\end{align*}

\subsubsection*{Zero noncoincidences}
In our case, if there are zero noncoincidences, it means that $\{a_1, a_2, a_3\} = \{b_1, b_2, b_3\}$. Note that these sets are not ordered, meaning the $a$'s can be permuted in relation to the $b$'s. The simplest case to look at is $a_1=b_1$, $a_2=b_2$ and $a_3=b_3$. Our results from last week then gives
\begin{align*}
\braopket{SD}{\op{G}}{SD}
&=  \frac{1}{2}\sum_{\alpha,\beta} \braopket{\alpha\beta}{\op{g}}{\alpha\beta}_{\rm AS} \\
&= \frac{1}{2}\big[ \braopket{11}{\op{g}}{11}_{\rm AS} + \braopket{12}{\op{g}}{12}_{\rm AS} + \braopket{13}{\op{g}}{13}_{\rm AS} \\
&\quad\ + \braopket{21}{\op{g}}{21}_{\rm AS} + \braopket{22}{\op{g}}{22}_{\rm AS} + \braopket{23}{\op{g}}{23}_{\rm AS} \\[0.1cm]
&\quad\ + \braopket{31}{\op{g}}{31}_{\rm AS} + \braopket{32}{\op{g}}{32}_{\rm AS} + \braopket{33}{\op{g}}{33}_{\rm AS}.
\end{align*}
Where we have introduced the shorthand $\braopket{ij}{\op{g}}{ij} \equiv \braopket{a_ia_j}{\op{g}}{b_ib_j}$. We now use the properties
$$\braopket{ii}{\op{g}}{ii} = 0 \quad \mbox{and} \quad \braopket{ij}{\op{q}}{ij}=\braopket{ji}{\op{q}}{ji},$$
which gives
$$\braopket{a_1a_2a_3}{\op{G}}{a_1a_2a_3} = \braopket{12}{\op{g}}{12}_{\rm AS} + \braopket{13}{\op{g}}{13}_{\rm AS} + \braopket{23}{\op{g}}{23}_{\rm AS}.$$
Which fits perfectly with out result this week. Note also that if we had permuted any of the $b$'s relative to the $a$'s, we would still have three terms in the result.

\subsubsection*{One noncoincidence}
We now let $a_1 = b_1$ and $a_2=b_2$, but $a_3 \neq b_3$. Our result from this week would then be
$$\braopket{a_1 a_2 a_3}{\op{G}}{a_1 a_2 b_3} = \braopket{13}{\op{g}}{13}_{\rm AS} + \braopket{23}{\op{g}}{23}_{\rm AS}.$$
From the previous week, this corresponds to
$$\braopket{SD}{\op{G}}{SD_{a_3}^{b_3}} = \sum_{\alpha} \braopket{\alpha a_3}{\op{g}}{\alpha b_3}_{\rm AS} = \braopket{13}{\op{g}}{13}_{\rm AS} + \braopket{23}{\op{g}}{23}_{\rm AS}.$$

\subsubsection*{Two noncoincidences}
Letting $a_1=b_1$, but $a_2 \neq b_2$ and $a_3 \neq b_3$, we see that only the first term in our result survives, and we have
$$\braopket{a_1 a_2 a_3}{\op{G}}{a_1 b_2 b_3} = \braopket{23}{\op{g}}{23}_{\rm AS}.$$
From last weeks result we have
$$\braopket{SD}{\op{G}}{SD_{a_2 a_3}^{b_2 b_3}} = \braopket{2 3}{\op{g}}{2 3}_{\rm AS},$$
and we see the two results are equal, as expected.

\subsubsection*{Three noncoincidences}
If none of the single-particle states are equal, we see that all of the Kronecker-deltas vanish, and the result is zero, just as we expected from last week.



\end{document}